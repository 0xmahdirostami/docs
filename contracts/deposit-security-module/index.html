<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.73">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Lido Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Lido Docs Blog Atom Feed"><title data-react-helmet="true">DepositSecurityModule | Lido Docs</title><meta data-react-helmet="true" property="og:url" content="https://lidofinance.github.io/contracts/deposit-security-module"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DepositSecurityModule | Lido Docs"><meta data-react-helmet="true" name="description" content="- Source Code"><meta data-react-helmet="true" property="og:description" content="- Source Code"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon-32x32.png"><link data-react-helmet="true" rel="canonical" href="https://lidofinance.github.io/contracts/deposit-security-module"><link data-react-helmet="true" rel="alternate" href="https://lidofinance.github.io/contracts/deposit-security-module" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://lidofinance.github.io/contracts/deposit-security-module" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.964611c4.css">
<link rel="preload" href="/assets/js/styles.60d6036a.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.dd8a6fd4.js" as="script">
<link rel="preload" href="/assets/js/main.09e3a1f9.js" as="script">
<link rel="preload" href="/assets/js/1.8e4f3c2a.js" as="script">
<link rel="preload" href="/assets/js/2.3255b1f9.js" as="script">
<link rel="preload" href="/assets/js/1a4e3797.2211e88d.js" as="script">
<link rel="preload" href="/assets/js/1be78505.fc09edae.js" as="script">
<link rel="preload" href="/assets/js/32.eae25c33.js" as="script">
<link rel="preload" href="/assets/js/31.6f8be8ee.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.744bd095.js" as="script">
<link rel="preload" href="/assets/js/17896441.d36306eb.js" as="script">
<link rel="preload" href="/assets/js/49cdd6a3.f01bfef8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Lido Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Lido Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Lido Docs</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lidofinance" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_MM2z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_s5VG searchBarLoadingRing_2jQk"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Lido Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Lido Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Lido Docs</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/lidofinance" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/lido-dao">Lido DAO</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/node-operator-manual">Node Operator Manual</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/oracle-operator-manual">Oracle Operator Manual</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/deposit-security-manual">Deposit Security Committee manual</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/multisig-deployment">Multisig deployment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/protocol-levers">Protocol levers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/guides/etherscan-voting">DAO voting with Etherscan</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Integrations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/integrations/sdk">SDKs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/integrations/subgraph">Subgraph</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Token guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/token-guides/steth-superuser-functions">StETH superuser functions</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Contracts</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/lido">Lido</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/lido-oracle">LidoOracle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/stable-swap-state-oracle">StableSwapStateOracle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/steth-price-feed">StEthPriceFeed</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/node-operators-registry">NodeOperatorsRegistry</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/withdrawals-manager-stub">WithdrawalsManagerStub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/wsteth">wstETH</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/contracts/deposit-security-module">DepositSecurityModule</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Security</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/security/bugbounty">Bug Bounties with Immunefi</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/deployed-contracts">Deployed Contracts</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">DepositSecurityModule</h1></header><div class="markdown"><ul><li><a href="https://github.com/lidofinance/lido-dao/blob/master/contracts/0.8.9/DepositSecurityModule.sol" target="_blank" rel="noopener noreferrer">Source Code</a></li><li><a href="https://etherscan.io/address/0xDb149235B6F40dC08810AA69869783Be101790e7" target="_blank" rel="noopener noreferrer">Deployed Contract</a></li></ul><p>Due to front-running vulnerability, we <a href="https://github.com/lidofinance/lido-improvement-proposals/blob/develop/LIPS/lip-5.md" target="_blank" rel="noopener noreferrer">proposed</a> to establish the Deposit Security Committee dedicated to ensuring the safety of deposits on the Beacon chain:</p><ul><li>monitoring the history of deposits and the set of Lido keys available for the deposit, signing and disseminating messages allowing deposits;</li><li>signing the special message allowing anyone to pause deposits once the malicious Node Operator pre-deposits are detected.</li></ul><p>Each member must generate an EOA address to sign messages with their private key. The addresses of the committee members will be added to the smart contract.</p><p>To make a deposit, we propose to collect a quorum of 2/3 of the signatures of the committee members. Members of the committee can collude with node operators and steal money by signing bad data that contains malicious pre-deposits. To mitigate this we propose to allow a single committee member to stop deposits and also enforce space deposits in time (e.g. no more than 150 deposits with 150 blocks in between them), to provide the single honest participant an ability to stop further deposits even if the supermajority colludes.</p><p>The guardian himself, or anyone else who has a signed pause message, can call <code>pauseDeposits</code> that pauses <code>DepositSecurityModule</code>.</p><p>To prevent a replay attack, the guardians sign the block number at the time of which malicious pre-deposits are observed. After a certain number of blocks (<code>pauseIntentValidityPeriodBlocks</code>) message becomes invalid.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="view-methods"></a>View Methods<a class="hash-link" href="#view-methods" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getnodeoperatorsregistry"></a>getNodeOperatorsRegistry()<a class="hash-link" href="#getnodeoperatorsregistry" title="Direct link to heading">#</a></h3><p>Returns NodeOperatorsRegistry contract address.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getNodeOperatorsRegistry() external view returns (address)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getpauseintentvalidityperiodblocks"></a>getPauseIntentValidityPeriodBlocks()<a class="hash-link" href="#getpauseintentvalidityperiodblocks" title="Direct link to heading">#</a></h3><p>Returns <code>PAUSE_INTENT_VALIDITY_PERIOD_BLOCKS</code> (see <code>pauseDeposits</code>).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getPauseIntentValidityPeriodBlocks() external view returns (uint256)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getmaxdeposits"></a>getMaxDeposits()<a class="hash-link" href="#getmaxdeposits" title="Direct link to heading">#</a></h3><p>Returns <code>MAX_DEPOSITS</code> (see <code>depositBufferedEther</code>).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getMaxDeposits() external view returns (uint256)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getmindepositblockdistance"></a>getMinDepositBlockDistance()<a class="hash-link" href="#getmindepositblockdistance" title="Direct link to heading">#</a></h3><p>Returns <code>MIN_DEPOSIT_BLOCK_DISTANCE</code>  (see <code>depositBufferedEther</code>).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getMinDepositBlockDistance() external view returns (uint256)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getguardianquorum"></a>getGuardianQuorum()<a class="hash-link" href="#getguardianquorum" title="Direct link to heading">#</a></h3><p>Returns number of valid guardian signatures required to vet (depositRoot, keysOpIndex) pair.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getGuardianQuorum() external view returns (uint256)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getguardians"></a>getGuardians()<a class="hash-link" href="#getguardians" title="Direct link to heading">#</a></h3><p>Returns guardian committee member list.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getGuardians() external view returns (address[] memory)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="isguardian"></a>isGuardian()<a class="hash-link" href="#isguardian" title="Direct link to heading">#</a></h3><p>Checks whether the given address is a guardian.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function isGuardian(address addr) external view returns (bool)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameters"></a>Parameters:<a class="hash-link" href="#parameters" title="Direct link to heading">#</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Valid ETH-1 address</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getguardianindex"></a>getGuardianIndex()<a class="hash-link" href="#getguardianindex" title="Direct link to heading">#</a></h3><p>Returns index of the guardian, or -1 if the address is not a guardian.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getGuardianIndex(address addr) external view returns (int256)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameters-1"></a>Parameters:<a class="hash-link" href="#parameters-1" title="Direct link to heading">#</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Valid ETH-1 address</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ispaused"></a>isPaused()<a class="hash-link" href="#ispaused" title="Direct link to heading">#</a></h3><p>Returns whether deposits were paused.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function isPaused() external view returns (bool)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="candeposit"></a>canDeposit()<a class="hash-link" href="#candeposit" title="Direct link to heading">#</a></h3><p>Returns whether depositBufferedEther can be called, given that the caller will provide
guardian attestations of non-stale deposit root and <code>keysOpIndex</code>, and the number of
such attestations will be enough to reach quorum.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function canDeposit() external view returns (bool)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="methods"></a>Methods<a class="hash-link" href="#methods" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getnodeoperatorsregistry-1"></a>getNodeOperatorsRegistry()<a class="hash-link" href="#getnodeoperatorsregistry-1" title="Direct link to heading">#</a></h3><p>Returns NodeOperatorsRegistry contract address.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getNodeOperatorsRegistry() external view returns (address)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setnodeoperatorsregistry"></a>setNodeOperatorsRegistry()<a class="hash-link" href="#setnodeoperatorsregistry" title="Direct link to heading">#</a></h3><p>Sets NodeOperatorsRegistry contract address. Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function setNodeOperatorsRegistry(address newValue)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameters-2"></a>Parameters:<a class="hash-link" href="#parameters-2" title="Direct link to heading">#</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>newValue</code></td><td><code>address</code></td><td>NodeOperatorsRegistry contract address</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="getpauseintentvalidityperiodblocks-1"></a>getPauseIntentValidityPeriodBlocks()<a class="hash-link" href="#getpauseintentvalidityperiodblocks-1" title="Direct link to heading">#</a></h3><p>Returns <code>pauseIntentValidityPeriodBlocks</code> (see <code>pauseDeposits</code>).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function getPauseIntentValidityPeriodBlocks() external view returns (uint256)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setpauseintentvalidityperiodblocks"></a>setPauseIntentValidityPeriodBlocks()<a class="hash-link" href="#setpauseintentvalidityperiodblocks" title="Direct link to heading">#</a></h3><p>Sets <code>pauseIntentValidityPeriodBlocks</code>. Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function setPauseIntentValidityPeriodBlocks(uint256 newValue)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameters-3"></a>Parameters:<a class="hash-link" href="#parameters-3" title="Direct link to heading">#</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>newValue</code></td><td><code>uint256</code></td><td>Number of blocks after which message becomes invalid</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setmaxdeposits"></a>setMaxDeposits()<a class="hash-link" href="#setmaxdeposits" title="Direct link to heading">#</a></h3><p>Sets <code>maxDepositsPerBlock</code>. Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function setMaxDeposits(uint256 newValue)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setmindepositblockdistance"></a>setMinDepositBlockDistance()<a class="hash-link" href="#setmindepositblockdistance" title="Direct link to heading">#</a></h3><p>Sets <code>minDepositBlockDistance</code>. Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function setMinDepositBlockDistance(uint256 newValue)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="setguardianquorum"></a>setGuardianQuorum()<a class="hash-link" href="#setguardianquorum" title="Direct link to heading">#</a></h3><p>Sets <code>quorum</code>. Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function setGuardianQuorum(uint256 newValue)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="addguardian"></a>addGuardian()<a class="hash-link" href="#addguardian" title="Direct link to heading">#</a></h3><p>Adds a guardian address and sets a new quorum value.
Reverts if the address is already a guardian.</p><p>Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function addGuardian(address addr, uint256 newQuorum)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameters-4"></a>Parameters:<a class="hash-link" href="#parameters-4" title="Direct link to heading">#</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Guardian address</td></tr><tr><td><code>newQuorum</code></td><td><code>uint256</code></td><td>New Quorum value</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="addguardians"></a>addGuardians()<a class="hash-link" href="#addguardians" title="Direct link to heading">#</a></h3><p>Adds a set of guardian addresses and sets a new quorum value.
Reverts any of them is already a guardian.</p><p>Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function addGuardians(address[] memory addresses, uint256 newQuorum)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addresses</code></td><td><code>address[]</code></td><td>Array of Guardian addresses</td></tr><tr><td><code>newQuorum</code></td><td><code>uint256</code></td><td>New Quorum value</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="removeguardian"></a>removeGuardian()<a class="hash-link" href="#removeguardian" title="Direct link to heading">#</a></h3><p>Removes a guardian with the given address and sets a new quorum value.</p><p>Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function removeGuardian(address addr, uint256 newQuorum)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameters-5"></a>Parameters:<a class="hash-link" href="#parameters-5" title="Direct link to heading">#</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Guardian address</td></tr><tr><td><code>newQuorum</code></td><td><code>uint256</code></td><td>New Quorum value</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="pausedeposits"></a>pauseDeposits()<a class="hash-link" href="#pausedeposits" title="Direct link to heading">#</a></h3><p>Pauses deposits given that both conditions are satisfied (reverts otherwise):</p><ol><li><p>The function is called by the guardian with index guardianIndex OR sig
is a valid signature by the guardian with index guardianIndex of the data
defined below.</p></li><li><p>block.number - blockNumber &lt;= pauseIntentValidityPeriodBlocks</p><p>The signature, if present, must be produced for keccak256 hash of the following
message (each component taking 32 bytes):</p><p>| PAUSE_MESSAGE_PREFIX | blockNumber</p></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function pauseDeposits(uint256 blockNumber, Signature memory sig)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="parameters-6"></a>Parameters:<a class="hash-link" href="#parameters-6" title="Direct link to heading">#</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>blockNumber</code></td><td><code>uint256</code></td><td>Block number</td></tr><tr><td><code>sig</code></td><td><code>Signature</code></td><td>Short ECDSA guardian signature as defined in <a href="https://eips.ethereum.org/EIPS/eip-2098" target="_blank" rel="noopener noreferrer">https://eips.ethereum.org/EIPS/eip-2098</a></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="unpausedeposits"></a>unpauseDeposits()<a class="hash-link" href="#unpausedeposits" title="Direct link to heading">#</a></h3><p>Unpauses deposits. Only callable by the owner.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function unpauseDeposits()</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="depositbufferedether"></a>depositBufferedEther()<a class="hash-link" href="#depositbufferedether" title="Direct link to heading">#</a></h3><p>Calls Lido.depositBufferedEther(maxDepositsPerBlock).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Reverts if any of the following is true:</p><ol><li>IDepositContract.get_deposit_root() != depositRoot.</li><li>INodeOperatorsRegistry.getKeysOpIndex() != keysOpIndex.</li><li>The number of guardian signatures is less than getGuardianQuorum().</li><li>An invalid or non-guardian signature received.</li><li>block.number - lastLidoDepositBlock &lt; MIN_DEPOSIT_BLOCK_DISTANCE</li><li>blockhash(blockNumber) == blockHash</li></ol></div></div><p>Signatures must be sorted in ascending order by index of the guardian. Each signature must
be produced for keccak256 hash of the following message (each component taking 32 bytes):</p><p>| ATTEST_MESSAGE_PREFIX | depositRoot | keysOpIndex | blockNumber | blockHash |</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sol"><div tabindex="0" class="prism-code language-sol codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">function depositBufferedEther(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 depositRoot,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 keysOpIndex,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 blockNumber,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 blockHash,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Signature[] memory sortedGuardianSignatures</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/lidofinance/docs/blob/main/docs/contracts/deposit-security-module.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/contracts/wsteth"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« wstETH</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/security/bugbounty"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Bug Bounties with Immunefi Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#view-methods" class="table-of-contents__link">View Methods</a><ul><li><a href="#getnodeoperatorsregistry" class="table-of-contents__link">getNodeOperatorsRegistry()</a></li><li><a href="#getpauseintentvalidityperiodblocks" class="table-of-contents__link">getPauseIntentValidityPeriodBlocks()</a></li><li><a href="#getmaxdeposits" class="table-of-contents__link">getMaxDeposits()</a></li><li><a href="#getmindepositblockdistance" class="table-of-contents__link">getMinDepositBlockDistance()</a></li><li><a href="#getguardianquorum" class="table-of-contents__link">getGuardianQuorum()</a></li><li><a href="#getguardians" class="table-of-contents__link">getGuardians()</a></li><li><a href="#isguardian" class="table-of-contents__link">isGuardian()</a></li><li><a href="#getguardianindex" class="table-of-contents__link">getGuardianIndex()</a></li><li><a href="#ispaused" class="table-of-contents__link">isPaused()</a></li><li><a href="#candeposit" class="table-of-contents__link">canDeposit()</a></li></ul></li><li><a href="#methods" class="table-of-contents__link">Methods</a><ul><li><a href="#getnodeoperatorsregistry-1" class="table-of-contents__link">getNodeOperatorsRegistry()</a></li><li><a href="#setnodeoperatorsregistry" class="table-of-contents__link">setNodeOperatorsRegistry()</a></li><li><a href="#getpauseintentvalidityperiodblocks-1" class="table-of-contents__link">getPauseIntentValidityPeriodBlocks()</a></li><li><a href="#setpauseintentvalidityperiodblocks" class="table-of-contents__link">setPauseIntentValidityPeriodBlocks()</a></li><li><a href="#setmaxdeposits" class="table-of-contents__link">setMaxDeposits()</a></li><li><a href="#setmindepositblockdistance" class="table-of-contents__link">setMinDepositBlockDistance()</a></li><li><a href="#setguardianquorum" class="table-of-contents__link">setGuardianQuorum()</a></li><li><a href="#addguardian" class="table-of-contents__link">addGuardian()</a></li><li><a href="#addguardians" class="table-of-contents__link">addGuardians()</a></li><li><a href="#removeguardian" class="table-of-contents__link">removeGuardian()</a></li><li><a href="#pausedeposits" class="table-of-contents__link">pauseDeposits()</a></li><li><a href="#unpausedeposits" class="table-of-contents__link">unpauseDeposits()</a></li><li><a href="#depositbufferedether" class="table-of-contents__link">depositBufferedEther()</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/styles.60d6036a.js"></script>
<script src="/assets/js/runtime~main.dd8a6fd4.js"></script>
<script src="/assets/js/main.09e3a1f9.js"></script>
<script src="/assets/js/1.8e4f3c2a.js"></script>
<script src="/assets/js/2.3255b1f9.js"></script>
<script src="/assets/js/1a4e3797.2211e88d.js"></script>
<script src="/assets/js/1be78505.fc09edae.js"></script>
<script src="/assets/js/32.eae25c33.js"></script>
<script src="/assets/js/31.6f8be8ee.js"></script>
<script src="/assets/js/935f2afb.744bd095.js"></script>
<script src="/assets/js/17896441.d36306eb.js"></script>
<script src="/assets/js/49cdd6a3.f01bfef8.js"></script>
</body>
</html>