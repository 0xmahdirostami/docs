<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">DepositSecurityModule | Lido Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://lidofinance.github.io/contracts/deposit-security-module"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="DepositSecurityModule | Lido Docs"><meta data-react-helmet="true" name="description" content="- Source Code"><meta data-react-helmet="true" property="og:description" content="- Source Code"><link data-react-helmet="true" rel="icon" href="/img/favicon-32x32.png"><link data-react-helmet="true" rel="canonical" href="https://lidofinance.github.io/contracts/deposit-security-module"><link data-react-helmet="true" rel="alternate" href="https://lidofinance.github.io/contracts/deposit-security-module" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://lidofinance.github.io/contracts/deposit-security-module" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.f9d99c6c.css">
<link rel="preload" href="/assets/js/runtime~main.585292e2.js" as="script">
<link rel="preload" href="/assets/js/main.6b7dd577.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Lido Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="Lido Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Lido Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lidofinance" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_CDc6"><kbd class="searchHint_2RRg">ctrl</kbd><kbd class="searchHint_2RRg">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/lido-dao">Lido DAO</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/guides/steth-integration-guide">stETH/wstETH integration guide</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/guides/node-operator-manual">Guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/integrations/wallets">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/token-guides/steth-superuser-functions">Token guides</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/contracts/lido">Contracts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/lido">Lido</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/lido-oracle">LidoOracle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/node-operators-registry">NodeOperatorsRegistry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/withdrawals-manager-stub">WithdrawalsManagerStub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/wsteth">wstETH</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/contracts/deposit-security-module">DepositSecurityModule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/self-owned-steth-burner">SelfOwnedStETHBurner</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/composite-post-rebase-beacon-receiver">CompositePostRebaseBeaconReceiver</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/lido-execution-layer-rewards-vault">LidoExecutionLayerRewardsVault</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contracts/mev-boost-relays-allowed-list">MevBoostRelayAllowedList</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/security/bugbounty">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/deployed-contracts/">Deployed contracts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deployed contracts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>DepositSecurityModule</h1></header><ul><li><a href="https://github.com/lidofinance/lido-dao/blob/master/contracts/0.8.9/DepositSecurityModule.sol" target="_blank" rel="noopener noreferrer">Source Code</a></li><li><a href="https://etherscan.io/address/0x710B3303fB508a84F10793c1106e32bE873C24cd" target="_blank" rel="noopener noreferrer">Deployed Contract</a></li></ul><p>Due to front-running vulnerability, we <a href="https://github.com/lidofinance/lido-improvement-proposals/blob/develop/LIPS/lip-5.md" target="_blank" rel="noopener noreferrer">proposed</a> to establish the Deposit Security Committee dedicated to ensuring the safety of deposits on the Beacon chain:</p><ul><li>monitoring the history of deposits and the set of Lido keys available for the deposit, signing and disseminating messages allowing deposits;</li><li>signing the special message allowing anyone to pause deposits once the malicious Node Operator pre-deposits are detected.</li></ul><p>Each member must generate an EOA address to sign messages with their private key. The addresses of the committee members will be added to the smart contract.</p><p>To make a deposit, we propose to collect a quorum of 2/3 of the signatures of the committee members. Members of the committee can collude with node operators and steal money by signing bad data that contains malicious pre-deposits. To mitigate this we propose to allow a single committee member to stop deposits and also enforce space deposits in time (e.g. no more than 150 deposits with 150 blocks in between them), to provide the single honest participant an ability to stop further deposits even if the supermajority colludes.</p><p>The guardian himself, or anyone else who has a signed pause message, can call <code>pauseDeposits</code> that pauses <code>DepositSecurityModule</code>.</p><p>To prevent a replay attack, the guardians sign the block number at the time of which malicious pre-deposits are observed. After a certain number of blocks (<code>pauseIntentValidityPeriodBlocks</code>) message becomes invalid.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="view-methods">View Methods<a class="hash-link" href="#view-methods" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getowner">getOwner()<a class="hash-link" href="#getowner" title="Direct link to heading">â€‹</a></h3><p>Returns the contract&#x27;s owner address.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getOwner() external view returns (address);</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getnodeoperatorsregistry">getNodeOperatorsRegistry()<a class="hash-link" href="#getnodeoperatorsregistry" title="Direct link to heading">â€‹</a></h3><p>Returns NodeOperatorsRegistry contract address.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getNodeOperatorsRegistry() external view returns (address)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getpauseintentvalidityperiodblocks">getPauseIntentValidityPeriodBlocks()<a class="hash-link" href="#getpauseintentvalidityperiodblocks" title="Direct link to heading">â€‹</a></h3><p>Returns <code>PAUSE_INTENT_VALIDITY_PERIOD_BLOCKS</code> (see <code>pauseDeposits</code>).</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getPauseIntentValidityPeriodBlocks() external view returns (uint256)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getmaxdeposits">getMaxDeposits()<a class="hash-link" href="#getmaxdeposits" title="Direct link to heading">â€‹</a></h3><p>Returns <code>MAX_DEPOSITS</code> (see <code>depositBufferedEther</code>).</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getMaxDeposits() external view returns (uint256)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getmindepositblockdistance">getMinDepositBlockDistance()<a class="hash-link" href="#getmindepositblockdistance" title="Direct link to heading">â€‹</a></h3><p>Returns <code>MIN_DEPOSIT_BLOCK_DISTANCE</code>  (see <code>depositBufferedEther</code>).</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getMinDepositBlockDistance() external view returns (uint256)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getguardianquorum">getGuardianQuorum()<a class="hash-link" href="#getguardianquorum" title="Direct link to heading">â€‹</a></h3><p>Returns number of valid guardian signatures required to vet (depositRoot, keysOpIndex) pair.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getGuardianQuorum() external view returns (uint256)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getguardians">getGuardians()<a class="hash-link" href="#getguardians" title="Direct link to heading">â€‹</a></h3><p>Returns guardian committee member list.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getGuardians() external view returns (address[] memory)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="isguardian">isGuardian()<a class="hash-link" href="#isguardian" title="Direct link to heading">â€‹</a></h3><p>Checks whether the given address is a guardian.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function isGuardian(address addr) external view returns (bool)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters">Parameters:<a class="hash-link" href="#parameters" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Valid ETH-1 address</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getguardianindex">getGuardianIndex()<a class="hash-link" href="#getguardianindex" title="Direct link to heading">â€‹</a></h3><p>Returns index of the guardian, or -1 if the address is not a guardian.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getGuardianIndex(address addr) external view returns (int256)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-1">Parameters:<a class="hash-link" href="#parameters-1" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Valid ETH-1 address</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ispaused">isPaused()<a class="hash-link" href="#ispaused" title="Direct link to heading">â€‹</a></h3><p>Returns whether deposits were paused.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function isPaused() external view returns (bool)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="candeposit">canDeposit()<a class="hash-link" href="#candeposit" title="Direct link to heading">â€‹</a></h3><p>Returns whether depositBufferedEther can be called, given that the caller will provide
guardian attestations of non-stale deposit root and <code>keysOpIndex</code>, and the number of
such attestations will be enough to reach quorum.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function canDeposit() external view returns (bool)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="getlastdepositblock">getLastDepositBlock()<a class="hash-link" href="#getlastdepositblock" title="Direct link to heading">â€‹</a></h3><p>Returns the last block that contains a deposit performed via this security module.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function getLastDepositBlock() external view returns (uint256)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="methods">Methods<a class="hash-link" href="#methods" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setowner">setOwner()<a class="hash-link" href="#setowner" title="Direct link to heading">â€‹</a></h3><p>Sets new owner. Only callable by the current owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function setOwner(address newValue) external;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-2">Parameters:<a class="hash-link" href="#parameters-2" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>newValue</code></td><td><code>address</code></td><td>New owner address</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setnodeoperatorsregistry">setNodeOperatorsRegistry()<a class="hash-link" href="#setnodeoperatorsregistry" title="Direct link to heading">â€‹</a></h3><p>Sets NodeOperatorsRegistry contract address. Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function setNodeOperatorsRegistry(address newValue)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-3">Parameters:<a class="hash-link" href="#parameters-3" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>newValue</code></td><td><code>address</code></td><td>NodeOperatorsRegistry contract address</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setpauseintentvalidityperiodblocks">setPauseIntentValidityPeriodBlocks()<a class="hash-link" href="#setpauseintentvalidityperiodblocks" title="Direct link to heading">â€‹</a></h3><p>Sets <code>pauseIntentValidityPeriodBlocks</code>. Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function setPauseIntentValidityPeriodBlocks(uint256 newValue)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-4">Parameters:<a class="hash-link" href="#parameters-4" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>newValue</code></td><td><code>uint256</code></td><td>Number of blocks after which message becomes invalid</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setmaxdeposits">setMaxDeposits()<a class="hash-link" href="#setmaxdeposits" title="Direct link to heading">â€‹</a></h3><p>Sets <code>maxDepositsPerBlock</code>. Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function setMaxDeposits(uint256 newValue)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setmindepositblockdistance">setMinDepositBlockDistance()<a class="hash-link" href="#setmindepositblockdistance" title="Direct link to heading">â€‹</a></h3><p>Sets <code>minDepositBlockDistance</code>. Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function setMinDepositBlockDistance(uint256 newValue)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setguardianquorum">setGuardianQuorum()<a class="hash-link" href="#setguardianquorum" title="Direct link to heading">â€‹</a></h3><p>Sets <code>quorum</code>. Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function setGuardianQuorum(uint256 newValue)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="addguardian">addGuardian()<a class="hash-link" href="#addguardian" title="Direct link to heading">â€‹</a></h3><p>Adds a guardian address and sets a new quorum value.
Reverts if the address is already a guardian.</p><p>Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function addGuardian(address addr, uint256 newQuorum)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-5">Parameters:<a class="hash-link" href="#parameters-5" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Guardian address</td></tr><tr><td><code>newQuorum</code></td><td><code>uint256</code></td><td>New Quorum value</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="addguardians">addGuardians()<a class="hash-link" href="#addguardians" title="Direct link to heading">â€‹</a></h3><p>Adds a set of guardian addresses and sets a new quorum value.
Reverts any of them is already a guardian.</p><p>Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function addGuardians(address[] memory addresses, uint256 newQuorum)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addresses</code></td><td><code>address[]</code></td><td>Array of Guardian addresses</td></tr><tr><td><code>newQuorum</code></td><td><code>uint256</code></td><td>New Quorum value</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="removeguardian">removeGuardian()<a class="hash-link" href="#removeguardian" title="Direct link to heading">â€‹</a></h3><p>Removes a guardian with the given address and sets a new quorum value.</p><p>Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function removeGuardian(address addr, uint256 newQuorum)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-6">Parameters:<a class="hash-link" href="#parameters-6" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>addr</code></td><td><code>address</code></td><td>Guardian address</td></tr><tr><td><code>newQuorum</code></td><td><code>uint256</code></td><td>New Quorum value</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="pausedeposits">pauseDeposits()<a class="hash-link" href="#pausedeposits" title="Direct link to heading">â€‹</a></h3><p>Pauses deposits given that both conditions are satisfied (reverts otherwise):</p><ol><li><p>The function is called by the guardian with index guardianIndex OR sig
is a valid signature by the guardian with index guardianIndex of the data
defined below.</p></li><li><p>block.number - blockNumber &lt;= pauseIntentValidityPeriodBlocks</p><p>The signature, if present, must be produced for keccak256 hash of the following
message (each component taking 32 bytes):</p><p>| PAUSE_MESSAGE_PREFIX | blockNumber</p></li></ol><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function pauseDeposits(uint256 blockNumber, Signature memory sig)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-7">Parameters:<a class="hash-link" href="#parameters-7" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>blockNumber</code></td><td><code>uint256</code></td><td>Block number with malicious pre-deposits have been observed by the guardian</td></tr><tr><td><code>sig</code></td><td><code>Signature</code></td><td>Short ECDSA guardian signature as defined in <a href="https://eips.ethereum.org/EIPS/eip-2098" target="_blank" rel="noopener noreferrer">https://eips.ethereum.org/EIPS/eip-2098</a></td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="unpausedeposits">unpauseDeposits()<a class="hash-link" href="#unpausedeposits" title="Direct link to heading">â€‹</a></h3><p>Unpauses deposits. Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function unpauseDeposits()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="setlastdepositblock">setLastDepositBlock()<a class="hash-link" href="#setlastdepositblock" title="Direct link to heading">â€‹</a></h3><p>Sets <code>lastDepositBlock</code>. Only callable by the owner.</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function setLastDepositBlock(uint256 newLastDepositBlock) external;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parameters-8">Parameters:<a class="hash-link" href="#parameters-8" title="Direct link to heading">â€‹</a></h4><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>newLastDepositBlock</code></td><td><code>uint256</code></td><td>Block number containing the last deposit</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_y2LR" id="depositbufferedether">depositBufferedEther()<a class="hash-link" href="#depositbufferedether" title="Direct link to heading">â€‹</a></h3><p>Calls Lido.depositBufferedEther(maxDepositsPerBlock).</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Reverts if any of the following is true:</p><ol><li>IDepositContract.get_deposit_root() != depositRoot.</li><li>INodeOperatorsRegistry.getKeysOpIndex() != keysOpIndex.</li><li>The number of guardian signatures is less than getGuardianQuorum().</li><li>An invalid or non-guardian signature received.</li><li>block.number - lastLidoDepositBlock &lt; MIN_DEPOSIT_BLOCK_DISTANCE</li><li>blockhash(blockNumber) == blockHash</li></ol></div></div><p>Signatures must be sorted in ascending order by index of the guardian. Each signature must
be produced for keccak256 hash of the following message (each component taking 32 bytes):</p><p>| ATTEST_MESSAGE_PREFIX | depositRoot | keysOpIndex | blockNumber | blockHash |</p><div class="codeBlockContainer_J+bg language-sol theme-code-block"><div class="codeBlockContent_csEI sol"><pre tabindex="0" class="prism-code language-sol codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">function depositBufferedEther(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 depositRoot,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 keysOpIndex,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        uint256 blockNumber,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        bytes32 blockHash,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        Signature[] memory sortedGuardianSignatures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/lidofinance/docs/blob/main/docs/contracts/deposit-security-module.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/contracts/wsteth"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">wstETH</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/contracts/self-owned-steth-burner"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SelfOwnedStETHBurner</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#view-methods" class="table-of-contents__link toc-highlight">View Methods</a><ul><li><a href="#getowner" class="table-of-contents__link toc-highlight">getOwner()</a></li><li><a href="#getnodeoperatorsregistry" class="table-of-contents__link toc-highlight">getNodeOperatorsRegistry()</a></li><li><a href="#getpauseintentvalidityperiodblocks" class="table-of-contents__link toc-highlight">getPauseIntentValidityPeriodBlocks()</a></li><li><a href="#getmaxdeposits" class="table-of-contents__link toc-highlight">getMaxDeposits()</a></li><li><a href="#getmindepositblockdistance" class="table-of-contents__link toc-highlight">getMinDepositBlockDistance()</a></li><li><a href="#getguardianquorum" class="table-of-contents__link toc-highlight">getGuardianQuorum()</a></li><li><a href="#getguardians" class="table-of-contents__link toc-highlight">getGuardians()</a></li><li><a href="#isguardian" class="table-of-contents__link toc-highlight">isGuardian()</a></li><li><a href="#getguardianindex" class="table-of-contents__link toc-highlight">getGuardianIndex()</a></li><li><a href="#ispaused" class="table-of-contents__link toc-highlight">isPaused()</a></li><li><a href="#candeposit" class="table-of-contents__link toc-highlight">canDeposit()</a></li><li><a href="#getlastdepositblock" class="table-of-contents__link toc-highlight">getLastDepositBlock()</a></li></ul></li><li><a href="#methods" class="table-of-contents__link toc-highlight">Methods</a><ul><li><a href="#setowner" class="table-of-contents__link toc-highlight">setOwner()</a></li><li><a href="#setnodeoperatorsregistry" class="table-of-contents__link toc-highlight">setNodeOperatorsRegistry()</a></li><li><a href="#setpauseintentvalidityperiodblocks" class="table-of-contents__link toc-highlight">setPauseIntentValidityPeriodBlocks()</a></li><li><a href="#setmaxdeposits" class="table-of-contents__link toc-highlight">setMaxDeposits()</a></li><li><a href="#setmindepositblockdistance" class="table-of-contents__link toc-highlight">setMinDepositBlockDistance()</a></li><li><a href="#setguardianquorum" class="table-of-contents__link toc-highlight">setGuardianQuorum()</a></li><li><a href="#addguardian" class="table-of-contents__link toc-highlight">addGuardian()</a></li><li><a href="#addguardians" class="table-of-contents__link toc-highlight">addGuardians()</a></li><li><a href="#removeguardian" class="table-of-contents__link toc-highlight">removeGuardian()</a></li><li><a href="#pausedeposits" class="table-of-contents__link toc-highlight">pauseDeposits()</a></li><li><a href="#unpausedeposits" class="table-of-contents__link toc-highlight">unpauseDeposits()</a></li><li><a href="#setlastdepositblock" class="table-of-contents__link toc-highlight">setLastDepositBlock()</a></li><li><a href="#depositbufferedether" class="table-of-contents__link toc-highlight">depositBufferedEther()</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.585292e2.js"></script>
<script src="/assets/js/main.6b7dd577.js"></script>
</body>
</html>