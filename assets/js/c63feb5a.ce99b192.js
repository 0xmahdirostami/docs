"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2266],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>f});var o=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t){if(null==e)return{};var r,o,a=function(e,t){if(null==e)return{};var r,o,a={},n=Object.keys(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)r=n[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var l=o.createContext({}),d=function(e){var t=o.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=d(e.components);return o.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var r=e.components,a=e.mdxType,n=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=d(r),u=a,f=c["".concat(l,".").concat(u)]||c[u]||h[u]||n;return r?o.createElement(f,i(i({ref:t},p),{},{components:r})):o.createElement(f,i({ref:t},p))}));function f(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var n=r.length,i=new Array(n);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,i[1]=s;for(var d=2;d<n;d++)i[d]=r[d];return o.createElement.apply(null,i)}return o.createElement.apply(null,r)}u.displayName="MDXCreateElement"},1590:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>n,metadata:()=>s,toc:()=>d});var o=r(3117),a=(r(7294),r(3905));const n={},i="General Overview",s={unversionedId:"guides/node-operators/general-overview",id:"guides/node-operators/general-overview",title:"General Overview",description:"Node Operators manage a secure and stable infrastructure for running Beacon validator clients",source:"@site/docs/guides/node-operators/general-overview.md",sourceDirName:"guides/node-operators",slug:"/guides/node-operators/general-overview",permalink:"/guides/node-operators/general-overview",draft:!1,editUrl:"https://github.com/lidofinance/docs/blob/main/docs/guides/node-operators/general-overview.md",tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"stETH/wstETH integration guide",permalink:"/guides/steth-integration-guide"},next:{title:"Validator Keys",permalink:"/guides/node-operators/validator-keys"}},l={},d=[{value:"The fee",id:"the-fee",level:2},{value:"Expressing interest to the DAO holders",id:"expressing-interest-to-the-dao-holders",level:2},{value:"Validator Exits Policy, Penalties, and Recovering",id:"validator-exits-policy-penalties-and-recovering",level:2}],p={toc:d},c="wrapper";function h(e){let{components:t,...r}=e;return(0,a.kt)(c,(0,o.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"general-overview"},"General Overview"),(0,a.kt)("p",null,"Node Operators manage a secure and stable infrastructure for running Beacon validator clients\nfor the benefit of the protocol. They\u2019re professional staking providers who can ensure the safety\nof funds belonging to the protocol users and correctness of validator operations."),(0,a.kt)("p",null,"The general flow is the following:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"A Node Operator expresses their interest to the DAO members. Their address gets proposed to the DAO vote for inclusion to the DAO's Node Operator list. Note that the Node Operator address should be supplied to the DAO with zero signing keys limit.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The DAO votes for including the Operator to the list of active operators. After successful\nvoting for inclusion, the Node Operator becomes active.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The Node Operator generates and submits a set of signing public keys and associated signatures\nfor future validators that will be managed by the Operator. When generating the signatures, the\nOperator must use withdrawal credentials derived from the withdrawal address supplied by the DAO.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The DAO members check the submitted keys for correctness and, if everything\u2019s good, vote for\napproving them. After successful approval, the keys become usable by the protocol.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The protocol distributes the pooled Ether evenly between all active Node Operators in ",(0,a.kt)("inlineCode",{parentName:"p"},"32 Ether"),"\nchunks. When it assigns the next deposit to a Node Operator, it takes the first non-used signing\nkey, as well as the associated signature, from the Node Operator\u2019s usable set and performs\na deposit to the official ",(0,a.kt)("inlineCode",{parentName:"p"},"DepositContract"),", submitting the pooled funds. At that time, the Node\nOperator should have the validator already running and configured with the public key being used.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"From this point, the Node Operator is responsible for keeping the validator associated with\nthe signing key operable and well-behaving.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"The protocol includes Oracles that periodically report the combined Beacon balance of all\nvalidators launched by the protocol. When the balance increases as a result of Beacon chain\nrewards, a fee is taken from the amount of rewards (see below for the details on how the fee\nis denominated) and distributed between active Node Operators.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"As withdrawals are requested, protocol publishes exit requests and Node Operators exit requested validators."))),(0,a.kt)("h2",{id:"the-fee"},"The fee"),(0,a.kt)("p",null,"The fee is taken as a percentage from Beacon chain rewards at the moment the Oracles report\nthose rewards. Oracles do that once in a while \u2014 the exact period is decided by the DAO members\nvia the voting process."),(0,a.kt)("p",null,"The total fee percentage, as well as the percentage that goes to all Node Operators, is also decided\nby the DAO voting and can be changed during the lifetime of the DAO. The Node Operators\u2019 part of the\nfee is distributed between the active Node Operators proportionally to the number of validators that\neach Node Operator runs."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"For example, if Oracles report that the protocol has received 10 Ether as a reward, the fee\npercentage that goes to Operators is ",(0,a.kt)("inlineCode",{parentName:"p"},"10%"),", and there are two active Node Operators, running\n",(0,a.kt)("inlineCode",{parentName:"p"},"2")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"8")," validators, respectively, then the first operator will receive ",(0,a.kt)("inlineCode",{parentName:"p"},"0.2")," stETH, the\nsecond \u2014 ",(0,a.kt)("inlineCode",{parentName:"p"},"0.8")," stETH.")),(0,a.kt)("p",null,"The fee is nominated in stETH, a liquid version of staked ETH introduced by the Lido protocol. The\ntokens correspond 1:1 to the Ether that the token holder would be able get by burning their stETH\nif transfers were already enabled in the Beacon chain. At any time point, the total amount of stETH\ntokens is equal to the total amount of Ether controlled by the protocol on both Execution Layer and Consensus Layer sides."),(0,a.kt)("p",null,"When a user submits Ether to the pool, they get the same amount of freshly-minted stETH tokens.\nWhen reward is received on the Consensus Layer side, each stETH holder\u2019s balance increases by the same\npercentage that the total amount of protocol-controlled Ether has increased, corrected for the\nprotocol fee which is taken by ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/lidofinance/lido-dao/blob/971ac8f/contracts/0.4.24/Lido.sol#L576"},"minting new stETH tokens")," to the fee recipients."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"For example, if the reward has increased the total amount of protocol-controlled Ether by ",(0,a.kt)("inlineCode",{parentName:"p"},"10%"),",\nand the total protocol fee percentage is ",(0,a.kt)("inlineCode",{parentName:"p"},"10%"),", then each token holder\u2019s balance will grow by\napproximately ",(0,a.kt)("inlineCode",{parentName:"p"},"9.09%"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"10%")," of the reward will be forwarded to the treasury, insurance fund\nand Node Operators.")),(0,a.kt)("p",null,"One side effect of this is that you, as a Node Operator, will continue receiving the percentage\nof protocol rewards even after you stop actively validating, if you chose to hold stETH received\nas a fee."),(0,a.kt)("h2",{id:"expressing-interest-to-the-dao-holders"},"Expressing interest to the DAO holders"),(0,a.kt)("p",null,"To include a Node Operator to the protocol, DAO holders must perform a voting. A Node Operator\nis defined by an address that is used for two purposes:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"The protocol pays the fee by minting stETH tokens to this address."),(0,a.kt)("li",{parentName:"ol"},"The Node Operator uses this address for submitting signing keys to be used by the protocol.")),(0,a.kt)("p",null,"Pass this address to the DAO holders along with the other relevant information."),(0,a.kt)("h2",{id:"validator-exits-policy-penalties-and-recovering"},"Validator Exits Policy, Penalties, and Recovering"),(0,a.kt)("p",null,"According to the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/lidofinance/documents-and-policies/blob/7595317b8fd2ee60ab25f5cac8eac2cc2cafa149/Lido%20on%20Ethereum%20-%20Validator%20Exits%20Policy.md"},"Lido on Ethereum Validator Exits Policy")," document, a Node Operator participating in the Lido on Ethereum protocol are responsible for correctly exiting validators within a specified timeframe determined by the protocol's requirements and rules set by the DAO."),(0,a.kt)("p",null,"In essence, if a Node Operator is unable to withdraw a validator within the time specified by the ",(0,a.kt)("inlineCode",{parentName:"p"},"VALIDATOR_DELINQUENT_TIMEOUT_IN_SLOTS")," parameter in the ",(0,a.kt)("inlineCode",{parentName:"p"},"OracleDaemonConfig")," contract, the accounting oracle report for that Node Operator increases the ",(0,a.kt)("inlineCode",{parentName:"p"},"STUCKED")," field by the number of delayed validators."),(0,a.kt)("p",null,"Therefore, a Node Operator is penalized if they have more ",(0,a.kt)("inlineCode",{parentName:"p"},"STUCKED")," validators than ",(0,a.kt)("inlineCode",{parentName:"p"},"REFUNDED")," validators. While this condition is met, the Node Operator receives only half of the rewards and no new stake allocations."),(0,a.kt)("p",null,"Once the Node Operator manages to either withdraw the required number of validators or compensate for the lost validators and increases the ",(0,a.kt)("inlineCode",{parentName:"p"},"REFUNDED")," count through DAO voting, the Node Operator is considered under penalty for the duration of the ",(0,a.kt)("inlineCode",{parentName:"p"},"STUCK_PENALTY_DELAY")," period and then returns to the normal state. Rewards are automatically restored to normal, but to start receiving new stake, the Node Operator (or anyone else) must call the permissionless method ",(0,a.kt)("inlineCode",{parentName:"p"},"clearNodeOperatorPenalty"),"."),(0,a.kt)("p",null,"To clear penalty please send a transaction with desired ",(0,a.kt)("inlineCode",{parentName:"p"},"_nodeOperatorId"),": ",(0,a.kt)("a",{parentName:"p",href:"https://etherscan.io/address/0x55032650b14df07b85bF18A3a3eC8E0Af2e028d5#writeProxyContract%23F2"},"https://etherscan.io/address/0x55032650b14df07b85bF18A3a3eC8E0Af2e028d5#writeProxyContract#F2")))}h.isMDXComponent=!0}}]);